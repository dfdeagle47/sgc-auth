define("SGAjax",[],function(){var t=require("backbone");t.getBearer=function(){return"bearer "+localStorage.token},t.getAuthorization=function(){return{Authorization:t.getBearer()}},t.setAuthorization=function(t){return localStorage.token=t},t.ajax=function(e){return e=_.defaults(e||{},{auth:!0}),e.contentType="application/json; charset=utf-8",e.auth&&(delete e.auth,e.headers=_.extend(e.headers||{},t.getAuthorization())),(_.isObject(e.data)||_.isArray(e.data))&&(e.data=JSON.stringify(e.data)),t.$.ajax.apply(t.$,arguments)}}),define("strategies/FacebookAuthModel",[],function(){var t=require("backbone");return t.Model.extend({facebookLogin:function(){return t.ajax({url:"/auth/facebook/login",type:"GET",auth:!1})},facebookLoginPopup:function(){var t=window.open("/auth/facebook/login","Facebook connect","scrollbars=yes,width=650,height=500"),e=$.Deferred(),o=window.setInterval(function(){if(t.closed!==!1){window.clearInterval(o);var a=this.get("token");a&&256===a.length?e.resolve():e.reject()}}.bind(this),10);return e.done(function(){this.set("state","logged-in")}.bind(this)).fail(function(){this.set("state","logged-out")}.bind(this)),e.promise()},facebookCallback:function(t){this.set("token",t.token,{localStorage:!0}),this.set("state","logged-in");var e=$.Deferred();return this!==top&&window.close(),setTimeout(function(){e.resolve()},100),e.promise()}})}),define("strategies/GoogleAuthModel",[],function(){var t=require("backbone");return t.Model.extend({googleLogin:function(){return t.ajax({url:"/auth/google/login",type:"GET",auth:!1})},googleLoginPopup:function(){var t=window.open("/auth/google/login","Google connect","scrollbars=yes,width=650,height=500"),e=$.Deferred(),o=window.setInterval(function(){if(t.closed!==!1){window.clearInterval(o);var a=this.get("token");a&&256===a.length?e.resolve():e.reject()}}.bind(this),10);return e.done(function(){this.set("state","logged-in")}.bind(this)).fail(function(){this.set("state","logged-out")}.bind(this)),e.promise()},googleCallback:function(t){this.set("token",t.token,{localStorage:!0}),this.set("state","logged-in");var e=$.Deferred();return this!==top&&window.close(),setTimeout(function(){e.resolve()},100),e.promise()}})}),define("strategies/BearerAuthModel",[],function(){var t=require("backbone");return t.Model.extend({bearerLogout:function(e){var o=t.ajax({url:"/auth/bearer/logout",type:"POST",data:e,auth:!0});return this.clear(),this.set("state","logged-out"),o}})}),define("strategies/LocalAuthModel",[],function(){var t=require("backbone");return t.Model.extend({localEasyRegister:function(e){var o=this,a=t.ajax({url:"/auth/local/easy_register",type:"POST",data:e,auth:!1});return a.done(function(t){o.set("token",t.token,{localStorage:!0}),o.set("state","logged-in")}).fail(function(){o.clear(),o.set("state","logged-out")}),a},localRegister:function(e){return t.ajax({url:"/auth/local/register",type:"POST",data:e,auth:!1})},localVerifyEmail:function(e){var o=this,a=t.ajax({url:"/auth/local/verify_email",type:"POST",data:e,auth:!1});return a.done(function(t){o.set("token",t.token,{localStorage:!0}),o.set("state","logged-in")}).fail(function(){o.clear(),o.set("state","logged-out")}),a},localLogin:function(e){var o=this,a=t.ajax({url:"/auth/local/login",type:"POST",data:e,auth:!1});return a.done(function(t){o.set("token",t.token,{localStorage:!0}),o.set("state","logged-in")}).fail(function(){o.clear(),o.set("state","logged-out")}),a},localChangePassword:function(e){var o=this,a=t.ajax({url:"/auth/local/change_password",type:"POST",data:e,auth:!0});return a.done(function(t){o.set("token",t.token,{localStorage:!0})}),a},localForgotPassword:function(e){return t.ajax({url:"/auth/local/forgot_password",type:"POST",data:e,auth:!1})},localResetPassword:function(e){var o=this,a=t.ajax({url:"/auth/local/reset_password",type:"POST",data:e,auth:!1});return a.done(function(t){o.set("token",t.token,{localStorage:!0}),o.set("state","logged-in")}).fail(function(){o.clear(),o.set("state","logged-out")}),a}})}),define("AuthModel",["./strategies/FacebookAuthModel","./strategies/GoogleAuthModel","./strategies/BearerAuthModel","./strategies/LocalAuthModel"],function(t,e,o,a){var r=require("backbone"),n=r.Model.extend({sync:function(t,e,o){return o.url&&this.testUrl&&(o.url=this.testUrl+o.url,o.headers={"Access-Control-Allow-Origin":"*"}),t||(t="read"),r.Model.prototype.sync.apply(this,[t,e,o])},getLocalStorageAttributes:function(){return this._localStorageAttributes||(this._localStorageAttributes={}),this._localStorageAttributes},set:function(t,e,o){return o=_.defaults(o||{},{localStorage:!1}),o.localStorage?void(_.isString(t)&&(localStorage[t]=e,this.getLocalStorageAttributes()[t]=!0)):r.Model.prototype.set.apply(this,arguments)},has:function(t){return t in this.getLocalStorageAttributes()?!0:r.Model.prototype.has.apply(this,arguments)},get:function(t){var e=r.Model.prototype.get.apply(this,arguments);return!e&&this.getLocalStorageAttributes()[t]?localStorage[t]:e},clear:function(){var t=this.getLocalStorageAttributes();for(var e in t)delete localStorage[e];return this._localStorageAttributes={},r.Model.prototype.clear.apply(this,arguments)}});return _.extend(n.prototype,t.prototype),_.extend(n.prototype,e.prototype),_.extend(n.prototype,o.prototype),_.extend(n.prototype,a.prototype),n}),define("sgc-auth",["require","./SGAjax","./AuthModel"],function(t){return t("./SGAjax"),t("./AuthModel")});